[workspace]
authors = ["adiezsanchez <adiez.biotech@gmail.com>"]
channels = ["pytorch", "nvidia", "conda-forge"]
name = "shreyag_ibd_orgs"
platforms = ["linux-64", "win-64"]
version = "0.1.0"

# -------------------------
# Activation-level environment (applies to all tasks)
# -------------------------
[activation.env]
# GPU (PyTorch CUDA + OpenCL): env lib first (CUDA runtime), then system (libcuda.so, libnvidia-opencl.so)
LD_LIBRARY_PATH = "$PIXI_PROJECT_ROOT/.pixi/envs/default/lib:/usr/lib/x86_64-linux-gnu:$LD_LIBRARY_PATH"

# -------------------------
# Tasks
# -------------------------

[tasks]
fix_opencl = "scripts/fix_opencl.sh"
fix_opencl_hpc = "scripts/fix_opencl_hpc.sh"

[tasks.lab]
cmd = "jupyter lab"

# -------------------------
# Conda-forge dependencies
# -------------------------

[dependencies]
python = "3.10.*"  
pytorch = "==2.5.0"
pytorch-cuda = "12.1.*"
torchvision = "==0.20.0"
cellpose = "==3.1.1.3" # Cellpose 3.0 with image restoration
apoc-backend = "*" # fast GPU classifiers (APOC)
edt = "*" # Euclidean distance transforms
ipykernel = "*" # Jupyter kernel support
ipython = "*" # interactive shell
jupyterlab = "*" # Jupyter environment
napari = "==0.5.4" # image viewer
nbformat = "*" # notebook parsing
nd2 = "*" # Nikon ND2 image reader
plotly = "*" # plotting library
pyyaml = "*" # YAML configuration file parsing
pyclesperanto-prototype = "*" # GPU image processing (OpenCL)
pyqt = "*" # GUI backend for napari
pydantic = "<2.0" # Avoid incompatibility between Pydantic and Napari
setuptools = "<81" # pin to avoid pkg_resources removal
seaborn = ">=0.13.2,<0.14"
umap-learn = ">=0.5.11,<0.6"

# -------------------------
# Platform-specific deps
# -------------------------

[target.linux-64.dependencies]
ocl-icd-system = "*"  # ICD to discover vendor OpenCL implementations
ffmpeg = ">=4.4.2,<5" # satisfy libopencv (conda-forge)
